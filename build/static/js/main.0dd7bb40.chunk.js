(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e){e.exports=[{label:"Tapahtuma",key:"title",type:"String"},{label:"Kuvaus",key:"description",type:"String"},{label:"Alkuaika",key:"startdate",type:"Date"},{label:"Loppuaika",key:"enddate",type:"Date"},{label:"Perustaja",key:"creator.username",type:"String"},{label:"P\xe4\xe4k\xe4ytt\xe4j\xe4t",key:"admins",type:"Count"},{label:"Muut osallistujat",key:"participants",type:"Count"},{label:"Kohde, nimi",key:"target.name",type:"String"},{label:"Kohde, leveyspiiri",key:"target.latitude",type:"Latitude"},{label:"Kohde, pituuspiiri",key:"target.longitude",type:"Longitude"},{label:"Kohde, tyyppi",key:"target.type",type:"String"},{label:"Kohde, syvyys",key:"target.depth",type:"String"},{label:"Kohde, materiaali",key:"target.material",type:"String"},{label:"Kohde, hylyt-tunnus",key:"target.hylyt_id",type:"Number"},{label:"Kohde, mj-tunnus",key:"target.mj_id",type:"String"},{label:"Sukellukset",key:"dives",type:"Count"}]},103:function(e){e.exports=[{label:"Kohde, nimi",key:"name",type:"String"},{label:"Kohde, leveyspiiri",key:"latitude",type:"Latitude"},{label:"Kohde, pituuspiiri",key:"longitude",type:"Longitude"},{label:"Kohde, tyyppi",key:"type",type:"String"},{label:"Kohde, syvyys",key:"depth",type:"String"},{label:"Kohde, materiaali",key:"material",type:"String"},{label:"Kohde, hylyt-tunnus",key:"hylyt_id",type:"Number"},{label:"Kohde, mj-tunnus",key:"mj_id",type:"String"},{label:"Sukellus, sukeltaja",key:"dives.dive.username",type:"String"},{label:"Sukellus, alkuaika",key:"dives.dive.startdate",type:"Date"},{label:"Sukellus, loppuaika",key:"dives.dive.enddate",type:"Date"},{label:"Sukellus, leveyspiiri",key:"dives.dive.latitude",type:"Latitude"},{label:"Sukellus, pituuspiiri",key:"dives.dive.longitude",type:"Longitude"}]},104:function(e){e.exports=[{label:"Kohde, nimi",key:"name",type:"String"},{label:"Kohde, leveyspiiri",key:"latitude",type:"Latitude"},{label:"Kohde, pituuspiiri",key:"longitude",type:"Longitude"},{label:"Kohde, tyyppi",key:"type",type:"String"},{label:"Kohde, syvyys",key:"depth",type:"String"},{label:"Kohde, materiaali",key:"material",type:"String"},{label:"Kohde, hylyt-tunnus",key:"hylyt_id",type:"Number"},{label:"Kohde, mj-tunnus",key:"mj_id",type:"String"}]},105:function(e){e.exports=[{label:"K\xe4ytt\xe4j\xe4, k\xe4ytt\xe4j\xe4nimi",key:"username",type:"String"},{label:"K\xe4ytt\xe4j\xe4, s\xe4hk\xf6posti",key:"email",type:"String"},{label:"Tapahtumat",key:"events",type:"Count"},{label:"Sukellukset",key:"dives",type:"Count"},{label:"Viestit",key:"messages",type:"Count"}]},108:function(e,t,a){},109:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(37),i=a.n(l),c=a(11),u=a(30),o=a(53),s=a(2),d=a.n(s),m=a(8),p="https://www.kyppi.fi/to.aspx?id=112.",g="http://192.168.137.1:3001/",f=a(16),E=a.n(f),h="".concat(g).concat("api/login/BO"),v={login:function(){var e=Object(m.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post(h,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loggedUser:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":case"RELOGIN_USER":case"LOGOUT_USER":return t.data;default:return e}},b=function(e,t,a){return function(){var n=Object(m.a)(d.a.mark(function n(r){return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:"SET_NOTIFICATION",data:{notMessage:t,notClass:e}}),n.next=3,setTimeout(function(){r({type:"CLEAR_NOTIFICATION"})},1e3*a);case 3:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{notMessage:"",notClass:"info"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data;case"CLEAR_NOTIFICATION":return"";default:return e}},j="".concat(g).concat("api/targets"),S={getAll:function(){var e=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get(j);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_TARGETS":return t.data;case"CLEAR_TARGETS":return null;default:return e}},F="".concat(g).concat("api/events/bo"),w={getAll:function(){var e=Object(m.a)(d.a.mark(function e(){var t,a,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!((a=window.localStorage.getItem("sukeltajaBOUser"))&&a.length>0&&"null"!==a)){e.next=7;break}n="bearer ".concat(JSON.parse(a).token),t={headers:{Authorization:n}},e.next=9;break;case 7:return console.log("Unauthorized call in eventService"),e.abrupt("return",null);case 9:return e.next=11,E.a.get(F,t);case 11:return r=e.sent,e.abrupt("return",r.data);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_EVENTS":return t.data;case"CLEAR_EVENTS":return null;default:return e}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAP_DIVES_TO_TARGETS":return t.data;case"CLEAR_DIVES":return null;default:return e}},C="".concat(g).concat("api/users"),T={getAll:function(){var e=Object(m.a)(d.a.mark(function e(){var t,a,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!((a=window.localStorage.getItem("sukeltajaBOUser"))&&a.length>0&&"null"!==a)){e.next=7;break}n="bearer ".concat(JSON.parse(a).token),t={headers:{Authorization:n}},e.next=9;break;case 7:return console.log("Unauthorized call in userService"),e.abrupt("return",null);case 9:return e.next=11,E.a.get(C,t);case 11:return r=e.sent,e.abrupt("return",r.data);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;case"CLEAR_USERS":return null;default:return e}},_=a(58),D="".concat(g).concat("api/bousers"),I=function(){var e=window.localStorage.getItem("sukeltajaBOUser");return e&&e.length>0&&"null"!==e?{headers:{Authorization:"bearer ".concat(JSON.parse(e).token)}}:(console.log("Unauthorized call in bouserService"),null)},L={getAll:function(){var e=Object(m.a)(d.a.mark(function e(){var t,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=I())){e.next=6;break}return e.next=4,E.a.get(D,t);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(m.a)(d.a.mark(function e(t,a,n){var r,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=I())){e.next=6;break}return e.next=4,E.a.post(D,{username:t,password:a,admin:n},r);case 4:return l=e.sent,e.abrupt("return",l.data);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}(),update:function(){var e=Object(m.a)(d.a.mark(function e(t){var a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("bouserService: update",t),null===(a=I())){e.next=9;break}return console.log("config ok"),e.next=6,E.a.put(D,t,a);case 6:return n=e.sent,console.log("put response status:",n.status,"data:",n.data),e.abrupt("return",n);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(m.a)(d.a.mark(function e(t){var a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(a=I())){e.next=6;break}return e.next=4,E.a.delete("".concat(D,"/").concat(t._id),a);case 4:return n=e.sent,e.abrupt("return",n);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},A=function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getAll();case 2:a=(a=e.sent).sort(function(e,t){return e.username.toUpperCase().localeCompare(t.username.toUpperCase())}),t({type:"INIT_BOUSERS",data:a});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BOUSERS":return t.data;case"ADD_BOUSER":return(e=[].concat(Object(_.a)(e),[t.data])).sort(function(e,t){return e.username.toUpperCase().localeCompare(t.username.toUpperCase())}),e;case"UPDATE_BOUSER":return(e=e.map(function(e){return e._id===t.data._id?t.data:e})).sort(function(e,t){return e.username.toUpperCase().localeCompare(t.username.toUpperCase())}),e;case"DELETE_BOUSER":return e.filter(function(e){return e._id!==t.data._id});case"CLEAR_BOUSERS":return null;default:return e}},B=Object(u.c)({authentication:y,notification:k,targets:O,events:x,targetDives:U,users:N,bousers:R}),K=Object(u.d)(B,Object(u.a)(o.a)),M=a(121),P=a(114),z=a(120),V=a(111),G=a(117),J=a(116),W=a(118),H=Object(c.b)(function(e){return{notMessage:e.notification.notMessage,notClass:e.notification.notClass}},null)(function(e){return void 0===e.notMessage||null===e.notMessage||""===e.notMessage?null:r.a.createElement("div",null,r.a.createElement("div",null,"\xa0"),r.a.createElement("div",null,r.a.createElement(W.a,{variant:e.notClass},e.notMessage)),r.a.createElement("div",null,"\xa0"))}),q=a(7),Q=a(119),X=a(115),Y=a(110),Z={loginUser:function(e,t){return function(){var a=Object(m.a)(d.a.mark(function a(n){var r;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v.login({username:e,password:t});case 2:return r=a.sent,a.next=5,window.localStorage.setItem("sukeltajaBOUser",JSON.stringify(r));case 5:return a.next=7,n({type:"LOGIN_USER",data:{loggedUser:r}});case 7:case"end":return a.stop()}},a,this)}));return function(e){return a.apply(this,arguments)}}()},reLoginUser:function(e){return function(){var t=Object(m.a)(d.a.mark(function t(a){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"RELOGIN_USER",data:{loggedUser:e}});case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},setNotification:b},$=Object(c.b)(function(e){return{loggedUser:e.authentication.loggedUser}},Z)(function(e){var t=Object(n.useState)(""),a=Object(q.a)(t,2),l=a[0],i=a[1],c=Object(n.useState)(""),u=Object(q.a)(c,2),o=u[0],s=u[1],p=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){var t=function(){var e=window.localStorage.getItem("sukeltajaBOUser");return e&&e.length>0&&"null"!==e?JSON.parse(e):null}();void 0!==t&&null!==t&&(e.reLoginUser(t),p())},[]);var g=function(){var t=Object(m.a)(d.a.mark(function t(a){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Logging in",l),a.preventDefault(),t.prev=2,t.next=5,e.loginUser(l,o);case 5:p(),window.location.href="/",t.next=14;break;case 9:return t.prev=9,t.t0=t.catch(2),console.log("Exception trying to login",l),t.next=14,e.setNotification("danger","K\xe4ytt\xe4j\xe4tunnus tai salasana on virheellinen",5);case 14:case"end":return t.stop()}},t,this,[[2,9]])}));return function(e){return t.apply(this,arguments)}}();return void 0===e.loggedUser||null===e.loggedUser?r.a.createElement("div",null,r.a.createElement("h2",null,"Sukeltaja Back Office"),r.a.createElement(X.a,{onSubmit:g},r.a.createElement(X.a.Group,null,r.a.createElement(X.a.Label,null,"K\xe4ytt\xe4j\xe4tunnus"),r.a.createElement(X.a.Control,{type:"text",name:"username",placeholder:"Sy\xf6t\xe4 k\xe4ytt\xe4j\xe4tunnus",onChange:function(e){i(e.target.value)}})),r.a.createElement(X.a.Group,null,r.a.createElement(X.a.Label,null,"Salasana"),r.a.createElement(X.a.Control,{type:"password",name:"password",placeholder:"Sy\xf6t\xe4 salasana",onChange:function(e){s(e.target.value)}})),r.a.createElement(X.a.Group,null,r.a.createElement(Y.a,{variant:"primary",type:"submit"},"Kirjaudu")),r.a.createElement("p",null))):"/"!==window.location.pathname?(console.log("Redirecting to /"),r.a.createElement(Q.a,{to:"/"})):null}),ee={logoutUser:function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT_USER",data:{loggedUser:null}});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},clearEvents:function(){return{type:"CLEAR_EVENTS"}},clearDives:function(){return{type:"CLEAR_DIVES"}},clearTargets:function(){return{type:"CLEAR_TARGETS"}},clearUsers:function(){return{type:"CLEAR_USERS"}},clearBOUsers:function(){return{type:"CLEAR_BOUSERS"}},setNotification:b},te=Object(c.b)(function(e){return{loggedUser:e.authentication.loggedUser}},ee)(function(e){var t=function(){var t=Object(m.a)(d.a.mark(function t(a){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,console.log("Logging out user",e.loggedUser.username),t.next=5,e.logoutUser();case 5:return window.localStorage.removeItem("sukeltajaBOUser"),t.next=8,e.clearEvents();case 8:return t.next=10,e.clearDives();case 10:return t.next=12,e.clearTargets();case 12:return t.next=14,e.clearUsers();case 14:return t.next=16,e.clearBOUsers();case 16:return t.next=18,e.setNotification("success","Olet kirjautunut ulos",5);case 18:return t.abrupt("return");case 21:t.prev=21,t.t0=t.catch(1),e.setNotification("danger","Kautta Neptunuksen! Uloskirjautuminen meni pieleen!",10);case 24:case"end":return t.stop()}},t,this,[[1,21]])}));return function(e){return t.apply(this,arguments)}}();return void 0===e.loggedUser||null===e.loggedUser?r.a.createElement(r.a.Fragment,null,"\xa0"):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{color:"black"}},"Sukeltamassa ",e.loggedUser.username,"\xa0",r.a.createElement(Y.a,{variant:"primary",size:"sm",type:"button",onClick:t},"Kirjaudu ulos")))}),ae=a(112),ne=a(55),re={setNotification:b},le=Object(c.b)(function(e){return{targetDives:e.targetDives,loggedUser:e.authentication.loggedUser}},re)(function(e){e.targetDives;return void 0!==e.loggedUser||null!==e.loggedUser?r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h2",null,"Sukeltaja Back Office"),r.a.createElement("div",null)),r.a.createElement("div",null,r.a.createElement(V.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement("h3",null,"Suosituimmat sukelluskohteet"))),r.a.createElement(ae.a,null,r.a.createElement(ne.a,{id:"caption"},"Kohde"),r.a.createElement(ne.a,{id:"caption"},"Sukelluksia")),null))))):"/"!==window.location.pathname?r.a.createElement(Q.a,{to:"/"}):null}),ie=a(113),ce=a(13),ue=a(56),oe=function(e){var t=function(e){return Math.floor(e)},a=function(e){return Math.floor(60*(e-t(e)))};return"".concat(t(e),"\xb0 ").concat(a(e),"' ").concat(function(e){return 60*(60*(e-t(e))-a(e))}(e).toFixed(4),'"')},se=function(e){var t=function(e){return e?"".concat(p).concat(e):void 0};if(e.target&&null!==e.target){var a=e.target;return r.a.createElement(V.a,{id:a._id,style:{margins:"0px"}},r.a.createElement(ae.a,null,r.a.createElement(ne.a,{id:"caption"},"Tyyppi:"),r.a.createElement(ne.a,null,a.type),r.a.createElement(ne.a,{id:"caption"},"Materiaali:"),r.a.createElement(ne.a,null,a.material),r.a.createElement(ne.a,{id:"caption"},"Syvyys:"),r.a.createElement(ne.a,null,a.depth)),r.a.createElement(ae.a,null,r.a.createElement(ne.a,{id:"caption"},"Museovirasto:"),r.a.createElement(ne.a,{lg:6},r.a.createElement("a",{href:t(a.mj_id)},t(a.mj_id))),r.a.createElement(ne.a,{lg:4},"\xa0")),r.a.createElement(ae.a,null,r.a.createElement(ne.a,{id:"caption"},"Hylyt.net:"),r.a.createElement(ne.a,{lg:6},r.a.createElement("a",{href:a.hylyt_link},a.hylyt_link)),r.a.createElement(ne.a,{lg:4},"\xa0")))}return null},de=a(59);ce.Settings.defaultLocale="fi";var me=function(e){var t=function(e){return e.toLocaleString(Object(de.a)({weekday:"short"},ce.DateTime.DATETIME_SHORT))};return t("string"===typeof e?ce.DateTime.fromISO(e):ce.DateTime.fromJSDate(e))},pe=function(e){if(e.dive&&null!==e.dive){var t=e.dive;return r.a.createElement(V.a,{id:t._id,style:{margins:"0px"}},r.a.createElement(ae.a,null,r.a.createElement(ne.a,{id:"caption"},"Sijainti:"),r.a.createElement(ne.a,{lg:6},"".concat(oe(t.latitude)),t.latitude>0?" N ":" S ","".concat(oe(t.longitude)),t.longitude>0?" E ":" W "),r.a.createElement(ne.a,{lg:4},"\xa0")))}return null},ge=function(e){var t=Object(n.useState)(!1),a=Object(q.a)(t,2),l=a[0],i=a[1];if(e.dive){var c=e.dive;return r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{onClick:function(){return i(!l)},"aria-controls":e.elementId,"aria-expanded":l,style:e.odd?{backgroundColor:"#ffffff"}:{backgroundColor:"#eeeeee"}},r.a.createElement("td",null,r.a.createElement("i",{className:l?"fas fa-caret-down":"fas fa-caret-right"})),r.a.createElement("td",{colSpan:"2",id:"dive"},c.user.username),r.a.createElement("td",{colSpan:"2",id:"dive"},me(c.startdate)),r.a.createElement("td",{colSpan:"2",id:"dive"},me(c.enddate))),r.a.createElement("tr",null,r.a.createElement(ue.a,{in:l},r.a.createElement("td",{colSpan:"7",id:c._id},r.a.createElement(pe,{dive:c})))))}return null},fe=function(e){var t=e.dives,a=Object(n.useState)(!1),l=Object(q.a)(a,2),i=l[0],c=l[1],u={margins:"0px"};if(t&&t.length>0)return r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{onClick:function(){return c(!i)},"aria-controls":e.elementId,"aria-expanded":i,width:"100%"},r.a.createElement("td",{width:"1%"},r.a.createElement("i",{className:i?"fas fa-caret-down":"fas fa-caret-right"})),r.a.createElement("td",{colSpan:"2",id:"caption"},"Sukeltaja"),r.a.createElement("td",{colSpan:"2",id:"caption"},"Alkuaika"),r.a.createElement("td",{colSpan:"2",id:"caption"},"Loppuaika")),r.a.createElement(ue.a,{in:i},r.a.createElement("tr",{id:e.elementId,style:u},r.a.createElement("td",{colSpan:"7",style:u},r.a.createElement("table",{style:u,width:"100%"},r.a.createElement("tbody",null,t.map(function(e,t){return r.a.createElement(ge,{key:"".concat(e._id).concat(t),dive:e,odd:t%2})})))))));return null},Ee=function(e){var t=Object(n.useState)(!1),a=Object(q.a)(t,2),l=a[0],i=a[1];if(void 0!==e.target&&null!==e.target){var c=e.target;return r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{onClick:function(){return i(!l)},"aria-controls":e.elementId,"aria-expanded":l,style:void 0!==c.dives?{backgroundColor:"#ddddff"}:{backgroundColor:"#ffffff"}},r.a.createElement("td",null,r.a.createElement("i",{className:l?"fas fa-caret-down":"fas fa-caret-right"})),r.a.createElement("td",{colSpan:"2"},c.name),r.a.createElement("td",{colSpan:"2"},"".concat(oe(c.latitude)),c.latitude>0?" N ":" S "),r.a.createElement("td",{colSpan:"2"},"".concat(oe(c.longitude)),c.longitude>0?" E ":" W ")),r.a.createElement(ue.a,{in:l},r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"7",id:e.elementId},r.a.createElement(se,{target:c})))),void 0!==c.dives?r.a.createElement(fe,{dives:c.dives}):null)}return null},he=function(e){var t=Object(n.useState)(!1),a=Object(q.a)(t,2),l=a[0],i=a[1],c=e.divingEvent,u=void 0!==c.description&&null!==c.description&&""!==c.description,o=void 0!==c.target&&null!==c.target,s=void 0!==c.dives&&null!==c.dives&&c.dives.length>0;return r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{onClick:function(){return i(!l)},"aria-controls":c._id,"aria-expanded":l},r.a.createElement("td",null,u||o?r.a.createElement("i",{className:l?"fas fa-caret-down":"fas fa-caret-right"}):null),r.a.createElement("td",null,me(e.divingEvent.startdate)),r.a.createElement("td",null,me(e.divingEvent.enddate)),r.a.createElement("td",null,e.divingEvent.creator.username),r.a.createElement("td",{colSpan:"3"},e.divingEvent.title)),u||o?r.a.createElement(ue.a,{in:l},r.a.createElement("tr",{id:c._id},r.a.createElement("td",{colSpan:"7"},r.a.createElement(ie.a,null,r.a.createElement("tbody",null,u?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"6",debug:"description"},e.divingEvent.description)):null,o?r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{id:"target"},r.a.createElement("td",{width:"2.5%"}),r.a.createElement("td",{width:"40%",colSpan:"2",id:"caption"},"Kohde"),r.a.createElement("td",{width:"57.5%",colSpan:"4",id:"caption"},"Sijainti")),r.a.createElement(Ee,{target:c.target,elementId:c._id.concat(c.target._id)})):null,s?r.a.createElement(fe,{dives:c.dives,elementId:"divesOf".concat(c)}):null))))):null)},ve=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"Alkaen"),r.a.createElement(X.a.Control,{type:"text",placeholder:"pp.kk.vvvv",name:"startdateFilter",value:e.startFilter,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa alkamisp\xe4iv\xe4n mukaan"))},ye=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"P\xe4\xe4ttyen"),r.a.createElement(X.a.Control,{type:"text",placeholder:"pp.kk.vvvv",name:"enddateFilter",value:e.endFilter,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa p\xe4\xe4ttymisp\xe4iv\xe4n mukaan"))},be=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"Perustaja"),r.a.createElement(X.a.Control,{type:"text",placeholder:"Perustajan k\xe4ytt\xe4j\xe4nimi",name:"creatorFilter",value:e.creatorFilter,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa tapahtuman perustajan k\xe4ytt\xe4j\xe4nimen osalla"))},ke=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"Nimi"),r.a.createElement(X.a.Control,{type:"text",placeholder:"Tapahtuman nimi",name:"titleFilter",value:e.titleFilter,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa tapahtuman nimen osalla"))},je=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"Kuvaus"),r.a.createElement(X.a.Control,{type:"text",placeholder:"Tapahtuman kuvaus",name:"descriptionFilter",value:e.descriptionFilter,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa tapahtuman kuvauksen osalla"))},Se=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Group,{as:ne.a},r.a.createElement(X.a.Label,null,e.title),r.a.createElement(X.a.Control,{type:"number",step:"0.1",min:"-90.0",max:"90.0",placeholder:"Esim 60,0",name:"latitudeFilter",value:e.latitudeFilter,onChange:e.latitudeTrigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa aluetta leveyspiirill\xe4 desimaaleina")),r.a.createElement(X.a.Group,{as:ne.a},r.a.createElement(X.a.Control,{type:"number",step:"0.1",min:"-180.0",max:"180.0",placeholder:"Esim 25,0",name:"longitudeFilter",value:e.longitudeFilter,onChange:e.longitudeTrigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa aluetta pituuspiirill\xe4 desimaaleina")))},Oe=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"Kohde"),r.a.createElement(X.a.Control,{type:"text",placeholder:"Kohteen nimi",name:"targetFilter",value:e.targetFilter,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa kohteen nimen osalla"))},Fe=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"K\xe4ytt\xe4j\xe4"),r.a.createElement(X.a.Control,{type:"text",placeholder:"K\xe4ytt\xe4j\xe4nimi",name:"usernameFilter",value:e.usernameFilter,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa k\xe4ytt\xe4j\xe4nimen osalla"))},we=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"S\xe4hk\xf6posti"),r.a.createElement(X.a.Control,{type:"text",placeholder:"joku@jossain.com",name:"emailFilter",value:e.emailFilter,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Rajaa s\xe4hk\xf6postiosoitteen osalla"))},xe=function(e){return r.a.createElement("div",null,r.a.createElement("div",{id:"caption"},"Suodata n\xe4ytett\xe4vi\xe4 tapahtumia"),r.a.createElement(X.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(ve,{value:e.startFilter,trigger:e.handleStartFiltering})),r.a.createElement(ne.a,null,r.a.createElement(ye,{value:e.endFilter,trigger:e.handleEndFiltering})),r.a.createElement(ne.a,null,r.a.createElement(be,{value:e.creatorFilter,trigger:e.handleCreatorFiltering}))),r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(ke,{value:e.titleFilter,trigger:e.handleTitleFiltering})),r.a.createElement(ne.a,null,r.a.createElement(je,{value:e.descriptionFilter,trigger:e.handleDescriptionFiltering})),r.a.createElement(ne.a,null,r.a.createElement(Oe,{value:e.targetFilter,trigger:e.handleTargetFiltering})))))},Ue=Object(c.b)(function(e){return{events:e.events}},null)(function(e){if(void 0===e.content||null===e.content)return null;var t=function(){var t={},n="";switch(e.contentType){case"events":t=a(102),n="sukellustapahtumat.csv";break;case"targetDives":t=a(103),n="kohteidensukellukset.csv";break;case"targets":t=a(104),n="kohteet.csv";break;case"users":t=a(105),n="kayttajat.csv"}var l=e.sep,i=e.dec,c=","===e.dec?".":",",u=[],o="";t.forEach(function(e){o=o.concat('"').concat(e.label).concat('";')}),o=o.concat("\n"),u.push(o);for(var s=!1,d=0,m=0,p=function(a){var n=e.content[a],r="";t.forEach(function(e){var t="",a="Number"===e.type?"":'"';if("Count"===e.type&&void 0!==n[e.key]&&null!==n[e.key])t=n[e.key].length;else if(e.key.includes("."))try{var u=e.key.split("."),o=n[u[0]],p=o[u[1]];if(void 0!==u[2]){s=!0;var g=Array.from(o);m=g.length-1,t=g[d][u[2]]}else void 0!==p&&null!=p&&(t=p)}catch(f){}else t=void 0===n[e.key]||null===n[e.key]?"":n[e.key];""!==t&&("Number"===e.type?t=t.toString().replace(c,i):"Latitude"===e.type?t="".concat(oe(t)).concat(t>0?" N ":" S "):"Longitude"===e.type&&(t="".concat(oe(t)).concat(t>0?" E ":" W "))),r=r.concat(a).concat(t).concat(a).concat(l)}),r=r.concat("\n"),u.push(r),d>=m?(s=!1,d=0):d++},g=0;g<e.content.length;s?null:g++)p(g);return{v:r.a.createElement(r.a.Fragment,null,function(){var e=new Blob(u,{type:"text/csv;charset=utf-8"}),t=window.URL.createObjectURL(e);return r.a.createElement("a",{href:t,type:"text/csv;charset=utf-8",download:n},"Lataa CSV")}())}}();return"object"===typeof t?t.v:void 0}),Ce=a(122),Te=function(e){var t=parseInt(e.current,10),a=e.pages,n=1,l=a;a>9&&(n=Math.max(1,t-4),l=Math.min(a,n+8),n=Math.max(1,l-8));var i=[];i.push(r.a.createElement(Ce.a.Item,{key:-9999999,id:1,onClick:e.handlePageSelect},"\u21e4")),i.push(r.a.createElement(Ce.a.Item,{key:-9999998,id:Math.max(1,t-1),onClick:e.handlePageSelect},"\u2190")),n>1&&i.push(r.a.createElement(Ce.a.Item,{key:-9999997,id:Math.max(1,t-9),onClick:e.handlePageSelect},"\u2026"));for(var c=n;c<=l;c++)i.push(r.a.createElement(Ce.a.Item,{key:c,id:c,active:c===t,onClick:e.handlePageSelect},c));return l<a&&i.push(r.a.createElement(Ce.a.Item,{key:9999997,id:Math.min(a,t+9),onClick:e.handlePageSelect},"\u2026")),i.push(r.a.createElement(Ce.a.Item,{key:9999998,id:Math.min(a,t+1),onClick:e.handlePageSelect},"\u2192")),i.push(r.a.createElement(Ce.a.Item,{key:9999999,id:a,onClick:e.handlePageSelect},"\u21e5")),r.a.createElement(Ce.a,null,i)},Ne={setNotification:b},_e=Object(c.b)(function(e){return{events:e.events,loggedUser:e.authentication.loggedUser}},Ne)(function(e){ce.Settings.defaultLocale="fi";var t=e.events,a=Object(n.useState)(1),l=Object(q.a)(a,2),i=l[0],c=l[1],u=Object(n.useState)(""),o=Object(q.a)(u,2),s=o[0],p=o[1],g=Object(n.useState)(""),f=Object(q.a)(g,2),E=f[0],h=f[1],v=Object(n.useState)(""),y=Object(q.a)(v,2),b=y[0],k=y[1],j=Object(n.useState)(""),S=Object(q.a)(j,2),O=S[0],F=S[1],w=Object(n.useState)(""),x=Object(q.a)(w,2),U=x[0],C=x[1],T=Object(n.useState)(""),N=Object(q.a)(T,2),_=N[0],D=N[1],I=Object(n.useState)(""),L=Object(q.a)(I,2),A=L[0],R=L[1],B=Object(n.useState)(""),K=Object(q.a)(B,2),M=K[0],P=K[1],z=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();function V(e){return e instanceof Date&&!isNaN(e)}Object(n.useEffect)(function(){z()},[]);var G=t.filter(function(e){return function(e){return 0===s.length||new Date(e.startdate)>=new Date(E)}(e)&&function(e){return 0===b.length||new Date(e.enddate)<=new Date(O)}(e)&&function(e){return!e.title&&0===U.length||e.title&&e.title.toUpperCase().includes(U.toUpperCase())}(e)&&function(e){return!e.description&&0===_.length||e.description&&e.description.toUpperCase().includes(_.toUpperCase())}(e)&&function(e){return!e.target&&0===A.length||e.target&&e.target.name.toUpperCase().includes(A.toUpperCase())}(e)&&function(e){return!e.creator.username&&0===M.length||void 0===e.creator.username||e.creator&&e.creator.username.toUpperCase().includes(M.toUpperCase())}(e)}),J=Math.ceil(G.length/20);return r.a.createElement("div",null,r.a.createElement("h2",null,"Sukellustapahtumat"),r.a.createElement(xe,{startFilter:s,handleStartFiltering:function(e){try{var t=ce.DateTime.fromFormat(e.target.value,"d.M.yyyy","fi-FI").toJSDate();V(t)&&h(t),p(e.target.value)}catch(a){console.log("Error with startdate",e.target.value)}},endFilter:b,handleEndFiltering:function(e){try{var t=ce.DateTime.fromFormat(e.target.value,"d.M.yyyy","fi-FI").plus({days:1}).plus({minutes:-1}).toJSDate();V(t)&&F(t),k(e.target.value)}catch(a){console.log("Error with enddate",e.target.value)}},titleFilter:U,handleTitleFiltering:function(e){C(e.target.value)},descriptionFilter:_,handleDescriptionFiltering:function(e){D(e.target.value)},targetFilter:A,handleTargetFiltering:function(e){R(e.target.value)},creatorFilter:M,handleCreatorFiltering:function(e){P(e.target.value)}}),r.a.createElement("div",{id:"caption"},"N\xe4ytet\xe4\xe4n ",G.length,"/",e.events.length," tapahtumaa. \xa0",void 0!==G&&null!==G?r.a.createElement(Ue,{contentType:"events",content:G,sep:";",dec:","}):null),r.a.createElement(ie.a,{bordered:!0,hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{width:"2.5%"}),r.a.createElement("th",{width:"17.5%"},"Alkuaika"),r.a.createElement("th",{width:"17.5%"},"Loppuaika"),r.a.createElement("th",{width:"15%"},"Perustaja"),r.a.createElement("th",{width:"47.5%",colSpan:"3"},"Tapahtuma"))),r.a.createElement("tbody",null,function(){var e=20*(i-1);return G.map(function(t,a){return a>=e&&a<e+20?r.a.createElement(he,{key:t._id,divingEvent:t}):null})}())),r.a.createElement(Te,{current:i,pages:J,handlePageSelect:function(e){try{c(parseInt(e.target.id))}catch(t){}}}))}),De=function(e){return r.a.createElement("div",null,r.a.createElement("div",{id:"caption"},"Suodata n\xe4ytett\xe4vi\xe4 kohteita"),r.a.createElement(X.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(ve,{value:e.startFilter,trigger:e.handleStartFiltering})),r.a.createElement(ne.a,null,r.a.createElement(ye,{value:e.endFilter,trigger:e.handleEndFiltering})),r.a.createElement(ne.a,null,r.a.createElement(Oe,{value:e.targetFilter,trigger:e.handleTargetFiltering}))),r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Se,{title:"Alueen luoteisnurkka",latitudeFilter:e.northFilter,latitudeTrigger:e.handleNorthFiltering,longitudeFilter:e.westFilter,longitudeTrigger:e.handleWestFiltering})),r.a.createElement(ne.a,null,r.a.createElement(Se,{title:"Alueen kaakkoisnurkka",latitudeFilter:e.southFilter,latitudeTrigger:e.handleSouthFiltering,longitudeFilter:e.eastFilter,longitudeTrigger:e.handleEastFiltering})))))},Ie={setNotification:b},Le=Object(c.b)(function(e){return{targets:e.targets,targetDives:e.targetDives,loggedUser:e.authentication.loggedUser}},Ie)(function(e){ce.Settings.defaultLocale="fi";var t=Object(n.useState)(1),a=Object(q.a)(t,2),l=a[0],i=a[1],c=Object(n.useState)(""),u=Object(q.a)(c,2),o=u[0],s=u[1],p=Object(n.useState)(""),g=Object(q.a)(p,2),f=g[0],E=g[1],h=Object(n.useState)(""),v=Object(q.a)(h,2),y=v[0],b=v[1],k=Object(n.useState)(""),j=Object(q.a)(k,2),S=j[0],O=j[1],F=Object(n.useState)(""),w=Object(q.a)(F,2),x=w[0],U=w[1],C=Object(n.useState)(70.1),T=Object(q.a)(C,2),N=T[0],_=T[1],D=Object(n.useState)(19),I=Object(q.a)(D,2),L=I[0],A=I[1],R=Object(n.useState)(59.4),B=Object(q.a)(R,2),K=B[0],M=B[1],P=Object(n.useState)(31.6),z=Object(q.a)(P,2),V=z[0],G=z[1],J=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();function W(e){return e instanceof Date&&!isNaN(e)}Object(n.useEffect)(function(){J()},[]);var H=e.targetDives.filter(function(e){return function(e){return 0===o.length||void 0!==e.dives&&new Date(e.firstDive)>=new Date(f)}(e)&&function(e){return 0===y.length||void 0!==e.dives&&new Date(e.lastDive)>=new Date(S)}(e)&&function(e){return 0===x.length||e&&e.name.toUpperCase().includes(x.toUpperCase())}(e)&&function(e){return null!==N&&0===N.length||e&&e.latitude<=N}(e)&&function(e){return null!==L&&0===L.length||e&&e.longitude>=L}(e)&&function(e){return null!==K&&0===K.length||e&&e.latitude>=K}(e)&&function(e){return null!==V&&0===V.length||e&&e.longitude<=V}(e)}),Q=Math.ceil(H.length/20);return r.a.createElement("div",null,r.a.createElement("h2",null,"Kohteiden sukellukset"),r.a.createElement(De,{startFilter:o,handleStartFiltering:function(e){try{var t=ce.DateTime.fromFormat(e.target.value,"d.M.yyyy","fi-FI").toJSDate();W(t)&&E(t),s(e.target.value),i(1)}catch(a){console.log("Error with startdate",e.target.value)}},endFilter:y,handleEndFiltering:function(e){try{var t=ce.DateTime.fromFormat(e.target.value,"d.M.yyyy","fi-FI").plus({days:1}).plus({minutes:-1}).toJSDate();W(t)&&O(t),b(e.target.value),i(1)}catch(a){console.log("Error with enddate",e.target.value)}},targetFilter:x,handleTargetFiltering:function(e){U(e.target.value),i(1)},northFilter:N,handleNorthFiltering:function(e){try{_(Number(e.target.value)),i(1)}catch(t){_(null)}},westFilter:L,handleWestFiltering:function(e){try{A(Number(e.target.value)),i(1)}catch(t){A(null)}},southFilter:K,handleSouthFiltering:function(e){try{M(Number(e.target.value)),i(1)}catch(t){M(null)}},eastFilter:V,handleEastFiltering:function(e){try{G(Number(e.target.value)),i(1)}catch(t){G(null)}}}),r.a.createElement("div",{id:"caption"},"N\xe4ytet\xe4\xe4n ",H.length,"/",e.targetDives.length," kohteesta, joissa sukelluksia. \xa0",void 0!==H&&null!==H?r.a.createElement(Ue,{contentType:"targetDives",content:H,sep:";",dec:","}):null),r.a.createElement(ie.a,{bordered:!0,hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",{id:"target"},r.a.createElement("th",{width:"2.5%"}),r.a.createElement("th",{width:"40%",colSpan:"2",id:"caption"},"Kohde"),r.a.createElement("th",{width:"57.5%",colSpan:"4",id:"caption"},"Sijainti"))),r.a.createElement("tbody",null,function(){var e=20*(l-1);return H.map(function(t,a){return a>=e&&a<e+20?r.a.createElement(Ee,{key:t._id,target:t,elementId:"divesOf".concat(t._id),dives:t.dives}):null})}())),r.a.createElement(Te,{current:l,pages:Q,handlePageSelect:function(e){try{i(parseInt(e.target.id))}catch(t){}}}))}),Ae=function(e){return r.a.createElement("div",null,r.a.createElement("div",{id:"caption"},"Suodata n\xe4ytett\xe4vi\xe4 kohteita"),r.a.createElement(X.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Oe,{value:e.targetFilter,trigger:e.handleTargetFiltering})),r.a.createElement(ne.a,null,r.a.createElement(Se,{title:"Alueen luoteisnurkka",latitudeFilter:e.northFilter,latitudeTrigger:e.handleNorthFiltering,longitudeFilter:e.westFilter,longitudeTrigger:e.handleWestFiltering})),r.a.createElement(ne.a,null,r.a.createElement(Se,{title:"Alueen kaakkoisnurkka",latitudeFilter:e.southFilter,latitudeTrigger:e.handleSouthFiltering,longitudeFilter:e.eastFilter,longitudeTrigger:e.handleEastFiltering})))))},Re={setNotification:b},Be=Object(c.b)(function(e){return{targets:e.targets,loggedUser:e.authentication.loggedUser}},Re)(function(e){var t=Object(n.useState)(1),a=Object(q.a)(t,2),l=a[0],i=a[1],c=Object(n.useState)(""),u=Object(q.a)(c,2),o=u[0],s=u[1],p=Object(n.useState)(70.1),g=Object(q.a)(p,2),f=g[0],E=g[1],h=Object(n.useState)(19),v=Object(q.a)(h,2),y=v[0],b=v[1],k=Object(n.useState)(59.4),j=Object(q.a)(k,2),S=j[0],O=j[1],F=Object(n.useState)(31.6),w=Object(q.a)(F,2),x=w[0],U=w[1],C=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){C()},[]);var T=e.targets.filter(function(e){return function(e){return 0===o.length||e&&e.name.toUpperCase().includes(o.toUpperCase())}(e)&&function(e){return null!==f&&0===f.length||e&&e.latitude<=f}(e)&&function(e){return null!==y&&0===y.length||e&&e.longitude>=y}(e)&&function(e){return null!==S&&0===S.length||e&&e.latitude>=S}(e)&&function(e){return null!==x&&0===x.length||e&&e.longitude<=x}(e)}),N=Math.ceil(T.length/20);return r.a.createElement("div",null,r.a.createElement("h2",null,"Kaikki kohteet"),r.a.createElement(Ae,{targetFilter:o,handleTargetFiltering:function(e){s(e.target.value),i(1)},northFilter:f,handleNorthFiltering:function(e){try{E(Number(e.target.value)),i(1)}catch(t){E(null)}},westFilter:y,handleWestFiltering:function(e){try{b(Number(e.target.value)),i(1)}catch(t){b(null)}},southFilter:S,handleSouthFiltering:function(e){try{O(Number(e.target.value)),i(1)}catch(t){O(null)}},eastFilter:x,handleEastFiltering:function(e){try{U(Number(e.target.value)),i(1)}catch(t){U(null)}}}),r.a.createElement("div",{id:"caption"},"N\xe4ytet\xe4\xe4n ",T.length,"/",e.targets.length," kohdetta. \xa0",void 0!==T&&null!==T?r.a.createElement(Ue,{contentType:"targets",content:T,sep:";",dec:","}):null),r.a.createElement(ie.a,{bordered:!0,hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",{id:"target"},r.a.createElement("th",{width:"2.5%"}),r.a.createElement("th",{width:"40%",colSpan:"2",id:"caption"},"Kohde"),r.a.createElement("th",{width:"57.5%",colSpan:"4",id:"caption"},"Sijainti"))),r.a.createElement("tbody",null,function(){var e=20*(l-1);return T.map(function(t,a){return a>=e&&a<e+20?r.a.createElement(Ee,{key:t._id,target:t,elementID:t._id}):null})}())),r.a.createElement(Te,{current:l,pages:N,handlePageSelect:function(e){try{i(parseInt(e.target.id))}catch(t){}}}))}),Ke=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"K\xe4ytt\xe4j\xe4tunnus"),r.a.createElement(X.a.Control,{type:"text",placeholder:"K\xe4ytt\xe4j\xe4tunnus",name:"usernameField",defaultValue:e.usernameField,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Sy\xf6t\xe4 k\xe4ytt\xe4j\xe4tunnus"))},Me=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"Salasana"),r.a.createElement(X.a.Control,{type:"password",placeholder:"Salasana",name:"passwordField",defaultValue:e.passwordField,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Sy\xf6t\xe4 salasana"))},Pe=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"Varmista salasana"),r.a.createElement(X.a.Control,{type:"password",placeholder:"Salasana uudestaan",name:"verifyField",defaultValue:e.verifyField,onChange:e.trigger}),r.a.createElement(X.a.Text,{className:"text-muted"},"Sy\xf6t\xe4 salasana uudestaan"))},ze=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a.Label,null,"P\xe4\xe4k\xe4ytt\xe4j\xe4"),r.a.createElement(X.a.Control,{as:"select",name:"adminField",defaultValue:!!e.adminField,onChange:e.trigger},r.a.createElement("option",{value:"false"},"Ei"),r.a.createElement("option",{value:"true"},"Kyll\xe4")),r.a.createElement(X.a.Text,{className:"text-muted"},"Valitse onko p\xe4\xe4k\xe4ytt\xe4j\xe4"))},Ve=function(e){var t=e.user,a=Object(n.useState)(!1),l=Object(q.a)(a,2),i=(l[0],l[1],Object(n.useState)(t.username)),c=Object(q.a)(i,2),u=(c[0],c[1],Object(n.useState)(t.email)),o=Object(q.a)(u,2),s=(o[0],o[1],void 0!==t.events&&null!==t.events&&t.events.length>0),d=void 0!==t.dives&&null!==t.dives&&t.dives.length>0,m=void 0!==t.messages&&null!==t.messages&&t.messages.length>0;return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("i",{className:"fas fa-user"})),r.a.createElement("td",null,t.username),r.a.createElement("td",null,t.email),r.a.createElement("td",null,s?t.events.length:0),r.a.createElement("td",null,d?t.dives.length:0),r.a.createElement("td",{colSpan:"2"},m?t.messages.length:0))},Ge=function(e){return r.a.createElement("div",null,r.a.createElement("div",{id:"caption"},"Suodata n\xe4ytett\xe4vi\xe4 k\xe4ytt\xe4ji\xe4"),r.a.createElement(X.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Fe,{value:e.usernameFilter,trigger:e.handleUsernameFiltering})),r.a.createElement(ne.a,null,r.a.createElement(we,{value:e.emailFilter,trigger:e.handleEmailFiltering})))))},Je={setNotification:b},We=Object(c.b)(function(e){return{users:e.users,loggedUser:e.authentication.loggedUser}},Je)(function(e){var t=e.users,a=Object(n.useState)(1),l=Object(q.a)(a,2),i=l[0],c=l[1],u=Object(n.useState)(""),o=Object(q.a)(u,2),s=o[0],p=o[1],g=Object(n.useState)(""),f=Object(q.a)(g,2),E=f[0],h=f[1],v=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){v()},[]);var y=t.filter(function(e){return function(e){return!e.username&&0===s.length||e.username&&e.username.toUpperCase().includes(s.toUpperCase())}(e)&&function(e){return!e.email&&0===E.length||e.email&&e.email.toUpperCase().includes(E.toUpperCase())}(e)}),b=Math.ceil(y.length/20);return r.a.createElement("div",null,r.a.createElement("h2",null,"Sukeltajat"),r.a.createElement(Ge,{usernameFilter:s,handleUsernameFiltering:function(e){p(e.target.value)},emailFilter:E,handleEmailFiltering:function(e){h(e.target.value)}}),r.a.createElement("div",{id:"caption"},"N\xe4ytet\xe4\xe4n ",y.length,"/",e.users.length," k\xe4ytt\xe4j\xe4\xe4. \xa0",void 0!==y&&null!==y?r.a.createElement(Ue,{contentType:"users",content:y,sep:";",dec:","}):null),r.a.createElement(ie.a,{bordered:!0,hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{width:"2.5%"}),r.a.createElement("th",{width:"30%"},"K\xe4ytt\xe4j\xe4"),r.a.createElement("th",{width:"30%"},"S\xe4hk\xf6posti"),r.a.createElement("th",{width:"12.5%"},"Tapahtumia"),r.a.createElement("th",{width:"12.5%"},"Sukelluksia"),r.a.createElement("th",{width:"12.5%",colSpan:"2"},"Viestej\xe4"))),r.a.createElement("tbody",null,function(){var e=20*(i-1);return y.map(function(t,a){return a>=e&&a<e+20?r.a.createElement(Ve,{key:t._id,user:t}):null})}())),r.a.createElement(Te,{current:i,pages:b,handlePageSelect:function(e){try{c(parseInt(e.target.id))}catch(t){}}}))}),He=function(e){return r.a.createElement("div",null,r.a.createElement(X.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Ke,{usernameField:e.usernameField,trigger:e.handleUsernameField})),r.a.createElement(ne.a,null,r.a.createElement(ze,{adminField:e.adminField,trigger:e.handleAdminField}))),r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Me,{passwordField:e.passwordField,trigger:e.handlePasswordField})),r.a.createElement(ne.a,null,r.a.createElement(Pe,{verifyField:e.verifyField,trigger:e.handleVerifyField}))),r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Y.a,{variant:"success",type:"button",value:e.bouserid,onClick:e.handleBOUserUpdate},"P\xe4ivit\xe4"),"\xa0",r.a.createElement(Y.a,{variant:"primary",type:"button",value:e.bouserid,onClick:e.handleBOUserCancel},"Peru"),"\xa0",r.a.createElement(Y.a,{variant:"danger",type:"button",value:e.bouserid,onClick:e.handleBOUserDelete},"Poista")),r.a.createElement(ne.a,null),r.a.createElement(ne.a,null))))},qe=function(e){return r.a.createElement("div",null,r.a.createElement(X.a,null,r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Ke,{usernameField:e.usernameField,trigger:e.handleUsernameField})),r.a.createElement(ne.a,null,r.a.createElement(ze,{adminField:e.adminField,trigger:e.handleAdminField}))),r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Me,{passwordField:e.passwordField,trigger:e.handlePasswordField})),r.a.createElement(ne.a,null,r.a.createElement(Pe,{verifyField:e.verifyField,trigger:e.handleVerifyField}))),r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(Y.a,{variant:"success",type:"button",value:e.bouserid,onClick:e.handleBOUserCreate},"Lis\xe4\xe4"),"\xa0",r.a.createElement(Y.a,{variant:"primary",type:"button",value:e.bouserid,onClick:e.handleBOUserCancel},"Peru")),r.a.createElement(ne.a,null),r.a.createElement(ne.a,null))))},Qe={createBOUser:function(e,t,a){return function(){var n=Object(m.a)(d.a.mark(function n(r){var l;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,L.create(e,t,a);case 2:l=n.sent,r({type:"ADD_BOUSER",data:l});case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},updateBOUser:function(e){return function(){var t=Object(m.a)(d.a.mark(function t(a){var n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("bouserReducer:update",e),t.next=3,L.update(e);case 3:n=t.sent,console.log("bouserReducer:response",n),204===n.status?a({type:"UPDATE_BOUSER",data:e}):(console.log("Something went wrong when updating a bo user"),a({type:"UPDATE_FAILED"}));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},deleteBOUser:function(e){return console.log("At the reducer",e),function(){var t=Object(m.a)(d.a.mark(function t(a){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("bouserReducer:delete",e),t.next=3,L.remove(e);case 3:a({type:"DELETE_BOUSER",data:e});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},initializeBOUsers:A},Xe=Object(c.b)(function(e){return{bousers:e.bousers,loggedUser:e.authentication.loggedUser}},Qe)(function(e){var t=e.bouser,a=Object(n.useState)(!1),l=Object(q.a)(a,2),i=l[0],c=l[1],u=Object(n.useState)(t.username),o=Object(q.a)(u,2),s=o[0],d=o[1],m=Object(n.useState)(""),p=Object(q.a)(m,2),g=p[0],f=p[1],E=Object(n.useState)(""),h=Object(q.a)(E,2),v=h[0],y=h[1],b=Object(n.useState)(t.admin),k=Object(q.a)(b,2),j=k[0],S=k[1],O=function(e){d(e.target.value)},F=function(e){f(e.target.value)},w=function(e){y(e.target.value)},x=function(e){S(e.target.value)},U=function(){d(""),f(""),S(!1),c(!1)},C=function(e){e.preventDefault(),U()};return"newBOUser"===t._id?r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{onClick:function(){return c(!i)},"aria-controls":t._id,"aria-expanded":i},r.a.createElement("td",null,r.a.createElement("i",{className:"fas fa-user-plus"})),r.a.createElement("td",null,"Lis\xe4\xe4 uusi Back Office k\xe4ytt\xe4j\xe4"),r.a.createElement("td",null,"\xa0")),r.a.createElement(ue.a,{in:i},r.a.createElement("tr",{id:t._id},r.a.createElement("td",{colSpan:"7"},r.a.createElement(qe,{bouserid:t._id,usernameField:s,handleUsernameField:O,passwordField:g,handlePasswordField:F,verifyField:v,handleVerifyField:w,adminField:j,handleAdminField:x,handleBOUserCancel:C,handleBOUserCreate:function(t){if(t.preventDefault(),g===v)try{e.createBOUser(s,g,j),U()}catch(a){console.log("Error handling create",a,t.target.value)}}}))))):r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{onClick:function(){return c(!i)},"aria-controls":t._id,"aria-expanded":i},r.a.createElement("td",null,r.a.createElement("i",{className:i?"fas fa-user-edit":"fas fa-user"})),r.a.createElement("td",null,t.username),r.a.createElement("td",null,j?"P\xe4\xe4k\xe4ytt\xe4j\xe4":"")),r.a.createElement(ue.a,{in:i},r.a.createElement("tr",{id:t._id},r.a.createElement("td",{colSpan:"7"},r.a.createElement(He,{bouserid:t._id,usernameField:s,handleUsernameField:O,passwordField:g,handlePasswordField:F,verifyField:v,handleVerifyField:w,adminField:j,handleAdminField:x,handleBOUserCancel:C,handleBOUserUpdate:function(a){if(a.preventDefault(),g===v)try{console.log("Handle update, id =",a.target.value,"username =",s,"admin =",j),t.username=s,t.password=g,t.admin=j,e.updateBOUser(t),c(!1)}catch(n){console.log("Error handling update",n,a.target.value)}},handleBOUserDelete:function(a){a.preventDefault();try{window.confirm("Haluatko varmasti poistaa k\xe4ytt\xe4j\xe4n ".concat(s,"?"))&&(console.log("Handle delete, id =",a.target.value,"username =",s,"admin =",j),e.deleteBOUser(t))}catch(n){console.log("Error handling delete",n,a.target.value)}}})))))}),Ye={setNotification:b},Ze=Object(c.b)(function(e){return{bousers:e.bousers,loggedUser:e.authentication.loggedUser}},Ye)(function(e){var t=e.bousers,a=void 0===e.bousers||null===e.bousers?0:e.bousers.length,l=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){l()},[]);return r.a.createElement("div",null,r.a.createElement("h2",null,"Back Office k\xe4ytt\xe4j\xe4t"),r.a.createElement("div",{id:"caption"},"N\xe4ytet\xe4\xe4n ",a,"/",a," Back Office k\xe4ytt\xe4j\xe4\xe4."),r.a.createElement(ie.a,{bordered:!0,hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{width:"2.5%"}),r.a.createElement("th",{width:"47.5%"},"K\xe4ytt\xe4j\xe4"),r.a.createElement("th",{width:"50%"},"P\xe4\xe4k\xe4ytt\xe4j\xe4"))),r.a.createElement("tbody",null,r.a.createElement(Xe,{key:"newBOUser",bouser:{_id:"newBOUser",admin:!1}}),void 0!==t&&null!==t?t.map(function(e){return r.a.createElement(Xe,{key:e._id,bouser:e})}):null)))}),$e={initializeTargets:function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getAll();case 2:a=(a=e.sent).sort(function(e,t){return"".concat(e.name,":").concat(e.mj_id).toUpperCase().localeCompare("".concat(t.name,":").concat(t.mj_id).toUpperCase())}),t({type:"INIT_TARGETS",data:a});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},initializeEvents:function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.getAll();case 2:a=(a=e.sent).sort(function(e,t){return new Date(t.startdate)-new Date(e.startdate)}),t({type:"INIT_EVENTS",data:a});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},mapDivesToTargets:function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){var a,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},e.next=3,w.getAll();case 3:if(void 0===(n=e.sent)||null===n||0===n.length){e.next=9;break}return r=new Map,e.next=8,n.forEach(function(e){if(void 0!==e.target&&null!==e.target&&void 0!==e.dives&&null!==e.dives&&e.dives.length>0){var t={},a={};r.has("".concat(e.target.name).concat(e.target.mj_id))?(t=(a=r.get("".concat(e.target.name).concat(e.target.mj_id))).dives).concat(e.dives):(a=e.target,t=Array.from(e.dives)),(t=t.sort(function(e,t){return new Date(t.startdate)-new Date(e.startdate)})).forEach(function(e){e.username=e.user.username}),a.dives=t,r.set("".concat(e.target.name).concat(e.target.mj_id),a)}});case 8:a=Array.from(r.values()).sort(function(e,t){return"".concat(e.name,":").concat(e.mj_id).toUpperCase().localeCompare("".concat(t.name,":").concat(t.mj_id).toUpperCase())});case 9:t({type:"MAP_DIVES_TO_TARGETS",data:a});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},initializeUsers:function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getAll();case 2:a=(a=e.sent).sort(function(e,t){return e.username.toUpperCase().localeCompare(t.username.toUpperCase())}),t({type:"INIT_USERS",data:a});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},initializeBOUsers:A,setNotification:b},et=Object(c.b)(function(e){return{targets:e.targets,events:e.events,targetDives:e.targetDives,users:e.users,bousers:e.bousers,loggedUser:e.authentication.loggedUser}},$e)(function(e){var t=function(){var t=Object(m.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setNotification("success","Tervetuloa! Muista hengitt\xe4\xe4 rauhallisesti!",5),void 0!==e.events&&null!==e.events&&0!==e.events.length){t.next=6;break}return t.next=4,e.initializeEvents();case 4:return t.next=6,e.mapDivesToTargets();case 6:if(void 0!==e.targets&&null!==e.targets&&0!==e.targets.length){t.next=9;break}return t.next=9,e.initializeTargets();case 9:if(void 0!==e.users&&null!==e.users&&0!==e.users.length){t.next=12;break}return t.next=12,e.initializeUsers();case 12:if(void 0!==e.bousers&&null!==e.bousers&&0!==e.bousers.length){t.next=15;break}return t.next=15,e.initializeBOUsers();case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}();Object(n.useEffect)(function(){var e=function(){var e=window.localStorage.getItem("sukeltajaBOUser");return e&&e.length>0&&"null"!==e?JSON.parse(e):null}();void 0!==e&&null!==e&&t()},[]);var a={};return void 0===e.loggedUser||null===e.loggedUser?r.a.createElement(V.a,null,r.a.createElement("div",{className:"justify-content-sm-center"},"\xa0"),r.a.createElement("div",{className:"justify-content-sm-center"},r.a.createElement(H,null)),r.a.createElement("div",{className:"justify-content-sm-center"},r.a.createElement($,null))):r.a.createElement(V.a,{style:{paddingTop:"70px"}},r.a.createElement(M.a,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(G.a,{fixed:"top",collapseOnSelect:!0,expand:"md",bg:"warning",variant:"dark"},r.a.createElement(G.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(G.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(J.a,null,r.a.createElement(J.a.Link,{as:"span"},r.a.createElement(P.a,{style:a,to:"/"},"Alkuun")),r.a.createElement(J.a.Link,{as:"span"},r.a.createElement(P.a,{style:a,to:"/targets"},"Kohteet")),r.a.createElement(J.a.Link,{as:"span"},r.a.createElement(P.a,{style:a,to:"/targetDives"},"Kohteiden sukellukset")),r.a.createElement(J.a.Link,{as:"span"},r.a.createElement(P.a,{style:a,to:"/events"},"Sukellustapahtumat")),r.a.createElement(J.a.Link,{as:"span"},r.a.createElement(P.a,{style:a,to:"/users"},"Sukeltajat")),r.a.createElement(J.a.Link,{as:"span"},r.a.createElement(P.a,{style:a,to:"/bousers"},"Backofficerit")),r.a.createElement(G.a.Text,{as:"span"},r.a.createElement(te,null)))))),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(H,null),r.a.createElement(z.a,{exact:!0,path:"/",render:function(){return r.a.createElement(le,null)}}),r.a.createElement(z.a,{exact:!0,path:"/targets",render:function(){return r.a.createElement(Be,null)}}),r.a.createElement(z.a,{exact:!0,path:"/targetDives",render:function(){return r.a.createElement(Le,null)}}),r.a.createElement(z.a,{exact:!0,path:"/events",render:function(){return r.a.createElement(_e,null)}}),r.a.createElement(z.a,{exact:!0,path:"/users",render:function(){return r.a.createElement(We,null)}}),r.a.createElement(z.a,{exact:!0,path:"/bousers",render:function(){return r.a.createElement(Ze,null)}}))))))});a(108);i.a.render(r.a.createElement(c.a,{store:K},r.a.createElement(et,null)),document.getElementById("root"))},60:function(e,t,a){e.exports=a(109)}},[[60,1,2]]]);
//# sourceMappingURL=main.0dd7bb40.chunk.js.map